from itertools import combinations
import pandas as pd

# List of words (确保源代码文件以UTF-8编码保存)
words = ["计算模拟", "好奇心", "驱动", "个体", "竞争胜利", "丰富", "行为选择"]

# Generate all combinations and store them in a list
combinations_list = []
for i in range(2, len(words) + 1):
    for combo in combinations(words, i):
        combinations_list.append(" + ".join(combo))
    combinations_list.append("")  

# Create a DataFrame
n = len(combinations_list) + 1
df = pd.DataFrame(index=range(n), columns=["concept combinations", "general investigation", "specific investigation"])

# Fill the first column
for i, combo in enumerate(combinations_list, start=1):
    df.at[i, "concept combinations"] = combo

# Remove NaN values
df.fillna("", inplace=True)

# Drop unnecessary rows
df = df.drop([0, df.index[-1]])

# 保存为CSV时使用UTF-8-SIG编码（带BOM），这样Excel打开不会乱码
df.to_csv(r"D:\新建文件夹\combination.csv", encoding='utf-8-sig', index=False)